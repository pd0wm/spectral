<!DOCTYPE html>
<html>
	<head>
		<title>WebSocket Client Test</title>
	</head>
	<body>
		<textarea id="output" style="width:300px;height:150px;" readonly=true></textarea>
		<br>
		<button id="toggleButton" onclick="toggleConnect()">Connect</button>
		<input type="text" id="input" />
		<button onclick="message()">Send</button>

		<script type="text/javascript">
			var socket;
			var output = document.getElementById("output");
			var input = document.getElementById("input");
			var toggleButton = document.getElementById("toggleButton");

			function onOpen (event) {
				writeLine('Connected to: ' + socket.url);
			}

			function onClose (event) {
				writeLine('Closed connection');
			}

			function onMessage (event) {
				writeLine('Received message: ' + event.data);
			}

			function onError (event) {
				writeLine('Error: ', event.data);
			}

			function toggleConnect() {
				if (socket instanceof WebSocket && socket.readyState == WebSocket.OPEN) {
					disconnect();
					toggleButton.innerHTML = "Connect";
				}
				else {
					connect();
					toggleButton.innerHTML = "Disconnect";
				}
			}

			function connect() {
				socket = new WebSocket("ws://127.0.0.1:9000");
				socket.onopen = function(event) { onOpen(event) };
				socket.onclose = function(event) { onClose(event) };
				socket.onmessage = function(event) { onMessage(event) };
				socket.onerror = function(event) { onError(event) };
			}

			function disconnect() {
				socket.close(1000);
			}

			function message() {
				if (socket instanceof WebSocket && socket.readyState == WebSocket.OPEN) {
					var message = input.value;
					socket.send(message);
					writeLine("Sent message: " + message);
					input.value = "";
				}
				else {
					writeLine("No active connection");
				}
			}

			function writeLine(line) {
				output.value += line + "\n";
			}
		</script>
	</body>
</html>

