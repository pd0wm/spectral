%!TEX program = xelatex
% http://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=5960831
\documentclass[a4paper, openany, oneside]{memoir}
\input{../includes/preamble.tex}
\addbibresource{../includes/bibliography.bib}

\title{Thesis}

\author{W.P. Bruinsma \and R.P. Hes \and H.J.C. Kroep \and T.C. Leliveld \and W.M. Melching \and T.A. aan de Wiel}

\raggedbottom

\begin{document}
\frontmatter

\begin{titlingpage}
  \pagestyle{empty}
  \maketitle
\end{titlingpage}

\chapter{Detection}

% Let $\hat{r}_x$ denote the \textit{recovered} autocorrelation function. By the Wiener Khinchin theorem, the PSD of signal $x$, which we'll denote as $S_x$, is
% equal to the Fourier transform of the $r_x$. That is, an estimate of $S_x$, $\hat{S}_x$ is given by:

% \begin{align*}
% \hat{S}_x = \mathcal{F} (\hat{r}_x)
% \end{align*}

% In case that $r_x = \delta (x)$, we have a ``flat'' PSD: every frequency is represented equally strong.  

\section{Spectral Flatness Algorithm}

Let the received signal be denoted by a WSS process $x[n]$:

\begin{align*}\label{eq:detect_cases}
x[n] &= \begin{cases}
    \eta[n], & \text{if no signal is present}.\\
    s[n] + \eta[n], & \text{if a signal is present}.
  \end{cases}
\end{align*}

The detection problem tries to find out which of the two cases in Eq. \ref{eq:detect_cases} applies.

The fact that $x[n]$ is WSS, however does not imply, that every random variable $x[i]$ as sampled by the receiver is drawn from the \emph{same} distribution. However, if we assume that $\eta[n]$ represents AWGN, then if no signal is present, each sample $x[i]$ is actually drawn from the same normal distribution. Assume now, that we can distinguish a signal $s[n]$ from noise $\eta[n]$ due to different samples in $s[n]$ having correlation with each other. That is, $r_s \neq \delta[n]$.  Then the samples $x[i]$ cannot be regared as realizations of independent random variables, and in addition we cannot ensure that those samples are drawn for the same distribution.

If $x[n]$ is available, we can use the Cramer-Von Mises statistic to test how good the distribution of the samples at the receiver resemble a normal
distribution (see \cite{}). 


In CS, however, $x[n]$ is \emph{not} available. One could try to reconstruct the spectrum and use an inverse fourier transform to obtain an estimate of $x[n]$. We will, however, work with an estimate of the PSD $\hat{P}(\omega)$.

The autocorrelation function, $r_x[n]$ of $x[n]$ is equal to:

\begin{align*}
	r_x[n] &= E ( x[m] x^{\ast}[m-n] ) \\
	          &= \sum_m x[m] x^{\ast}[m-n]
\end{align*}
.

The PSD of $x[n]$, denoted by $\mathcal{P}(\omega)$ is given by:

\begin{align*}
	\mathcal{P}(\omega) &= \mathcal{F}(r_x) \\
\end{align*}

where $r_x$ denotes the discrete Fourier Transform. 

Assume now, that we obtain an estimate of $r_x$, given by $\hat{r}_x$. Although $r_x$ itself is \emph{not} a random process (it is an  expected value), the estimate $\hat{r}_x$ is (and in case of an unbiased estimate $E[\hat{r}_x] = r_x$): the estimate $\hat{r}_x$ is based on a \emph{limited} amount of samples of a realization of the random process $x[n]$. 

By Fourier transforming the estimate $\hat{r}_x$, we obtain an estimate of the PSD, $\hat{\mathcal{P}}(\omega)$. Now let $\vec{\hat{r}}_x$ be a vector with $(\vec{\hat{r}}_x)_i = \hat{r}_x[i]$. Then:

\begin{align*}
	\hat{\mathcal{P}}(\omega) &= W \vec{\hat{r}}_x
\end{align*}

where $W$ is the DFT matrix. In the the theoritical case of AWGN, each frequency is equally represented in the PSD, implying infinite energy.
If we assume that the noise present in $x[n]$ is \emph{bandlimited}, then: 

\begin{align*}
	P_\eta(\omega) &= \begin{cases}
	c & \text{for $\omega_1 \leq |\omega| \leq \omega_2$} \\
	0 & \text{elsewhere}
	\end{cases} 
\end{align*}

This assumption implies, that the samples of $\hat{\mathcal{P}}_x$, in case that no signal is represented, are drawn from a common uniform distribution (as $E[\hat{\mathcal{P}}_x(\omega)] = c$).

Now, if we use the Cramer-Von-Mises test statistic on $N$ samples of our PSD estimate $\hat{\mathcal{P}}(\omega)$:

\begin{align*}
d
\end{align*}


% Let the received signal be represented by the stochastic process 

% \begin{align*}
% 	X(t) &= S(t) + H(t)
% \end{align*}

% with $S(t)$ the stochastic process representing the undistorted signal and $H(t)$ the stochastic process representing the Additive White Gaussian  Noise. Theoretically, $r_H = \delta(t)$ and $S_H = c$ with $c$ a constant. This, however, implies infinite energy. We will, from now on, assume that our noise is \emph{bandlimited}, that is, we approximate the PSD of $H$ by a rectangular waveform. Furthermore, we assume that the autocorrelation of our signal to be detected is is not equal to a delta: that is a sample is not completely independent of other samples in the signal.

% Due to the fact that $S(t)$ and $H(t)$ are uncorrelated:

% \begin{align*}
% r_X(t) = r_S(t) + r_H(t)
% \end{align*} 

% We know consider two different possibilities:

% \begin{enumerate}
% 	\item $S(t) = 0$: In this case, we say that there's no signal present. Therefore $S_x = S_H$
% 	\item $S(t) \neq 0$: in this case, a signal is present and $S_x = S_S + S_H$
% \end{enumerate}

% Our algorithm tries to measure the ``flatness'' of the PSD $S_S$. We'll motivate and elobarate flatness in section \ref{}

% \section{Flatness}

% Let a signal be described by a random WSS sequence $X_n$, that is:

% \begin{align*}
% 	E[X_n] 
% \end{align*}

% % Given a signal $x[n]$ ($0 \leq n \leq L-1$)  that is, a time-limited realization of the stochastic process $X[n]$. Let

% % \begin{align*}
% % \vec{x} = [x[0], \ldots, x[L-1] ]^T
% % \end{align*} $
% The autocorrelation of this sequence is given by $r_{X}[n] = \sum_k x_k x^{\ast}_{k-n}$  and therefore its spectrum $S_X$:

% \begin{align*}
% 	S_X = \mathcal{F}(r_X)
% \end{align*}

% with $\mathcal{F}(\cdot)$ the discrete Fourier transform. 

\end{document}