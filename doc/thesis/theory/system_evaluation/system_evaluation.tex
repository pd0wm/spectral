%!TEX program = xelatex

\documentclass[a4paper, openany, oneside]{memoir}
\input{../../../includes/preamble.tex}
\addbibresource{../../includes/bibliography.bib}

\begin{document}

\section{Introduction}

\cref{cha:sampling,cha:reconstruction,cha:sampling_methods,cha:detection} have analysed and described several
sampling, reconstruction and detection techniques. It is in this chapter that we will evaluate their performance such that a discussion and a conclusion can be draw based on the specifications as described \cref{sec:theory-specs}. This chapter will start with an overview of the complete system, to continue with a description of the tests performed to assess the performance of this system. This chapter will end with the results
of those tests which will be discussed in \textbf{verwijs naar discussie chapter}.

\section{Overview}
A block diagram of the complete system is depicted in \cref{fig:theoretical_overview_system}. Considered options that did not make it into
the final system are grayed out. 

\begin{figure}[H]
\centering
\begin{tikzpicture}
\draw  (-2,3) rectangle (0,2) node[pos=.5]{\scriptsize Circular sparse};
\draw  (-2,1.5) rectangle (0,0.5) node[pos=.5]{\scriptsize Collaborative};
\draw  (-2,0) rectangle (0,-1) node[pos=.5]{\scriptsize Coprime};
\draw  (1.5,3) rectangle (3.5,2) node[text width=5cm, align=center,pos=.5]{\scriptsize modified $r_x$\\ reconstruction};
\draw  [fill=lightgray] (1.5,0) rectangle (3.5,-1) node[text width=5cm, align=center,pos=.5]{\scriptsize $r_x$\\ reconstruction};
\draw  [fill=lightgray](1.5,1.5) rectangle (3.5,0.5) node[text width=5cm, align=center,pos=.5]{\scriptsize $\ell_1$-based\\ reconstruction};
\draw  (3.8,3) rectangle (5.8,2) node[text width=5cm, align=center,pos=.5]{\scriptsize Modified\\\tiny energy detection};
\draw  [fill=lightgray] (3.8,1.5) rectangle (5.8,0.5) node[text width=5cm, align=center,pos=.5]{\scriptsize Conventional\\\tiny energy detection};
\draw  [fill=lightgray](3.8,0) rectangle (5.8,-1) node[pos=.5]{\scriptsize CAV};
\draw  [dashed] (1.2,4) rectangle (6.1,-1.3);
\node at (3.6,3.5) {Toolkit};
\draw [>=latex,->] (3.5,2.5) -- (3.8,2.5);
\draw [>=latex,->] (5.8,2.5) -- (6.8,2.5);
\draw [>=latex,->] (0,2.5) -- (1.5,2.5);
\draw [>=latex,->] (-3,2.5) -- (-2,2.5);
\draw [>=latex,->] (-3,1) -- (-2,1);
\draw [>=latex,->] (-3,-0.5) -- (-2,-0.5);
\draw (0,-0.5) -- (0.9,-0.5);
\draw (0,1) -- (0.9,1);
\draw (-3,-0.5) -- (-3,4);
\draw (0.9,-0.5) -- (0.9,2.5);
\draw (-2.8,4) -- (-3,3.8);
\draw (-3.2,4) -- (-3,3.8);
\node at (3.5,3) {};
\end{tikzpicture}
\caption{Overview of complete system \& design choices}
\label{fig:theoretical_overview_system}
\end{figure}

\section{Testing}
To evaluate the performance of our system we will we use an artificial testing signal to test both the reconstructor and the detector.
Details on this signal generation can be found in \cref{ssec:test_signal}.

\subsection{Test signal}\label{ssec:test_signal}
To construct the testing signal given a desired SNR we take the following steps:

\begin{enumerate}
	\item Generate the signal $s[n]$ which is done by generating circular symmetric complex gaussian noise and filtering it such that it represents a bandpass signal with $-0.4\pi \leq \Omega \leq 0.4\pi$. The average power of the signal at frequencies in the passband is chosen such
	that the required SNR will be met. 
	\item Generate the additive circular symmetric complex gaussian noise signal $w[n]$ 
	\item Add $s[n]$ to $w[n]$ to produce the testing signal $x[n]$
\end{enumerate}



\subsection{Tests}
There are four parameters of the system, circled in \cref{tkz:test_system}, that will be used in our tests to asses the performance of the system:
\begin{enumerate}
	\item SNR of the input signal.
	\item The sampler type used to sample the input signal.
	\item The false alarm probability $p\ss{fa}$ of the detector.
\end{enumerate}

\begin{figure}[H]
\centering
\begin{tikzpicture}

\draw  (-2,3.5) rectangle (0,2.5) node[pos=.5]{Noise};
\draw  (-2,1.5) rectangle (0,0.5) node[pos=.5]{Signal};
\draw  (1.5,3) ellipse (.5 and .5);
\draw  [fill=lightgray](3,3.5) rectangle (5,2.5) node[pos=.5]{Sampler};
\draw  [fill=lightgray](6,3.5) rectangle (9,2.5) node[pos=.5]{Reconstructor};
\draw  [fill=lightgray](6,1.5) rectangle (9,0.5) node[pos=.5]{Detector};
\draw  [fill=blue, opacity=.1](3,1.5) rectangle (5,0.5);
\draw  (3,1.5) rectangle (5,0.5)node[pos=.5]{Compare};



\draw (1.5,2.6) -- (1.5,3.4);
\draw (1.9,3) -- (1.1,3);
\draw [>=latex, ->] (0,3) -- (1,3);
\draw [>=latex, ->] (9.5,1) -- (9,1);
\draw [>=latex, ->] (4,4.5) -- (4,3.5);
\draw [>=latex, ->] (1.5,1) -- (1.5,2.5);
\draw [>=latex, ->] (-3,3) -- (-2,3);
\draw [>=latex, ->] (6,1) -- (5,1);
\draw [>=latex, ->] (0,1) -- (3,1);
\draw [>=latex, ->] (7.5,2.5) -- (7.5,1.5);
\draw [>=latex, ->] (2,3) -- (3,3);
\draw [>=latex, ->] (5,3) -- (6,3);


\draw   [fill=yellow, opacity=.1] (-3.5,3) ellipse (.5 and .5);
\draw   [fill=yellow, opacity=.1] (10,1) ellipse (.5 and .5);

\draw   [fill=yellow, opacity=.1] (4,5) ellipse (.5 and .5);

\draw   (-3.5,3) ellipse (.5 and .5) node{SNR};
\draw  (10,1) ellipse (.5 and .5) node{$P_{fa}$};

\draw  (4,5) ellipse (.5 and .5) node{Type};

\end{tikzpicture}
\caption{Testing the system}\label{tkz:test_system}
\end{figure}

Our tests will be targeted at
\begin{enumerate}
	\item adressing the performance of the reconstruction and feeding it an artificial constructed signal while
	\begin{enumerate}
		\item varying the sampling technique used to sample the signal (as described in \cref{cha:sampling_methods});
		\item varying the compression rate and the oversampling factor (as described in \cref{cha:reconstruction}).
	\end{enumerate}
	By comparing the reconstructed the power spectral density to the power spectral density recovered directly from the constructed test signal, we can evaluate the correctness of reconstruction when used with a specific sampling technique.
	Furthermore the dependence on the oversampling factor and the compression factor can be evaluated from those test results. 
	\item adressing the performance of detection on the reconstructed signal. The energy detector as described in \cref{ssec:ari_ed} will be evaluated by tests that make use of the test signal as described in \cref{ssec:test_signal}. 
	The detector is applied to the output of the reconstructor while	
	\begin{enumerate}
		\item varying the signal-to-noise ratio of the test signal; 
		\item varying the false alarm probability the detector 
		should allow;
		\item varying the compression rate of the reconstructor.
	\end{enumerate}
	Using these results we can construct the receiver operating characteristic curves (ROC-curves) which plot the detection probability versus the false alarm probability of the detector. From these curves the minimum signal strength and the detectors performance on a random signal can be evaluated. Furthermore the detection performance of the system as a whole can be evaluated by comparing these curves for different compression rates.
	\end{enumerate}

\section{Results}

\begin{filecontents*}{plots/plot-data.csv}
x, y
1, 1
2, 3
3, 4
4, 3
\end{filecontents*}
\begin{figure}
	\centering
	\begin{tikzpicture}
		\begin{axis}[
				xlabel={Sampling time at 25 MHz (ms)},
				ylabel={Normalised mean squared error of PSD ($\log_{10}$)},
				width=8cm,
				height=8cm,
				scale=1,
				grid=both,
				axis lines=left
			]
		    \addplot [
			    color=red,
			    solid,
			    mark=o
		    ] table [x=x, y=y, col sep=comma]{plots/plot-data.csv};
		\end{axis}
	\end{tikzpicture}
	\caption{test}
	\label{fig:plot}
\end{figure}






\end{document}
