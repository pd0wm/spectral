%!TEX program = xelatex

\documentclass[a4paper, openany, oneside]{memoir}
\input{../../../../includes/preamble.tex}
\addbibresource{../../../../includes/bibliography.bib}

\begin{document}

\section{Main analysis}

Let $\vec{x} \in \mathbb{C}^{N}$ denote the received signal. %The input of the algorithm consists of an estimate of $E(\vec{r}_x)$), which we will denote by $\vec{r}'_x$. 

The algorithm must decide between to hypotheses:

\begin{align}\label{eq:hypotheses}
  \mathcal{H}_0&: \vec{x} = \vec{n}\\
  \mathcal{H}_1&: \vec{x} = \vec{s} + \vec{n}
\end{align}

in which $\vec{n}$ denotes a noise signal and $\vec{s}$ denotes the signal
at the receiver. 

% Under the assumption that $\vec{n}$ represents AWGN, we have that $(\vec{n})_i \sim \mathcal{N}(0, \sigma_n^2)$. Furthermore, its autocorrelation, which will be denoted by $\vec{r}_n$, is equal to:

% \begin{align*}
%   \vec{r}_n = \vec{\delta}
% \end{align*}

\subsection{Energy Detection}
Energy detection is based on the \emph{Neyman-Pearson Test} to decide wether there is or isn't a signal present in the received signal $\vec{x}$. Instead of using the likelihood function in the test statistic, energy detection, resorts to the \emph{log-likelihood}. Therefore,  given
the signal $\vec{x}$

\begin{align*}
\Lambda(\vec{x}) &= \frac{\log (\prod_{i=1}^N \frac{1}{\sqrt{2 \pi \sigma_n^2}} \exp ( \frac{(\vec{x})_i^2}{2\sigma_n^2}))}{\log (\prod_{i=1}^N \frac{1}{\sqrt{2 \pi (\sigma_n^2+\sigma_s^2)}} \exp ( \frac{(\vec{x})_i^2}{2(\sigma_n^2 + \sigma_s^2)}))} \\
&= \frac{n}{2}(2\pi\sigma_s^2 ) +( -\frac{1}{2\sigma_n^2} + \frac{1}{2(\sigma_n^2 + \sigma^2_s)})(\vec{x} \cdot \vec{x}) \\
&= a + b  (\vec{x} \cdot \vec{x})
\end{align*}

Observing that the constants $a$ and $b$ do not depend on the signal itself, we can simplify the test statistic to:

\begin{align*}
\Lambda'(\vec{x}) &= (\vec{x} \cdot \vec{x})
\end{align*} 

As stated in \cite{axell2012spectrum}, a constant false alarm rate (CFAR)of the detector is a desirable property. Under $\mathcal{H}_0$, $ \frac{2\Lambda'(\vec{x})}{\sigma_n^2}$ follows a chi-square distribution with 2N degrees of freedom \cite{%http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=6584537.
 }. Approximating this chi-square distribution by a Gaussian, using the Central Limit theorem, it can be found that
 the probability of false alarm is equal to

 \begin{align}
 P_{fa} = P(\Lambda'(\vec{x}) > \eta) = Q(\frac{\eta -\sigma_n^2}{\sqrt{\frac{2}{N}\sigma^2_n}}).\label{eq:p_fa}
 \end{align} \cite{
 %http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=6061767
 }
 Observe the dependency on the noise variance $\sigma_n^2$ in  \cref{eq:p_fa}. That is, to determine $\eta$ for a certain false alarm rate,
 it is necessary that one knows (an estimate of) $\sigma_n^2$.

By dividing $\Lambda'$ by $N$, we create another test statistic $\Lambda'' = E[(x)_i^2] = (r_{(\vec{x})_0})$, where $r_{\vec{x}}$ denotes the autocorrelation of the received signal. We can create an analogue test statistic for samples in the spectral domain by nothing that

\begin{align}
    E[(x)_i^2]  = \int_{-\infty}^{\infty} S_x (f) df
\end{align}

where $S_x(f)$ denotes the power spectral density of the signal. 


\subsection{Estimation of the noise variance}
To determine the threshold for the test statistic, it is necessary that we can estimate the noise variance 

% http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=6809311
% http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=6061767
 

\end{document}