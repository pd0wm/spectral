%!TEX program = xelatex

\documentclass[a4paper, openany, oneside]{memoir}
\input{../../../../includes/preamble.tex}
\addbibresource{../../../../includes/bibliography.bib}

\begin{document}

\section{Main analysis Ariananda}

We assume that if our signal $x[n]$ purely contains noise, the elements of $\vec{x}$ are i.i.d. circular complex gaussian distributed; $(\vec{x})_i \sim \mathcal{CN}(0,\sigma_n)$. 

In this section we will analyze how the elements of the power spectral density can serve as the test statistic as used in the Neyman-Pearson test. 

\subsection{Distribution of PSD elements}
To employ the Neyman-Pearson theorem to determine the threshold at frequency $\omega$, it is necessary that one knows the distribution of $\mathcal{P}\left(\omega\right)$. Only if this distribution is known, the threshold $\eta_{\omega}$ can correctly be set to yield the desired false alarm probability.

Note that 

\begin{align*}
\mathcal{P}\left(\omega\right) &= \sum_{n=-\infty}^{\infty} r_{x}[n] \exp\left[-jn\omega\right]
\end{align*}

and therefore the distribution of $\mathcal{P}(\omega)$ depends on the distribution of \emph{all} elements of the autocorrelation. Furthermore, the elements of the autocorrelation, can in general not be regarded as independent random variables. This illustrates that the distribution of $\mathcal{P}(\omega)$, is not trivial to derive. 

Let $(\vec{s}_x) = \mat{F} \vec{\hat{r}}_x$, where $\mat{F}$ denotes the $2LN-1 \times 2LN-1$ DFT matrix, denote the vector containing the elements of the power spectral density of $\vec{x}$. That is the element $\left(\vec{s}_{x}\right)_{i}$ denotes the component of the power spectral density at $\omega = \frac{2\pi (i-1)}{2LN-1}$.

\begin{blockTheorem}[Distribution of power spectral density elements]\label{th:psd_distr}
Under the assumption that $\vec{x}$ is circular complex gaussian noise and $L-1 \ll KL$, the elements of $\vec{s}_x$ are approximately gaussian distributed.
\end{blockTheorem}

Using this approximation, it is possible to determine the distribution of the elements  of $\vec{s}_x$: by determining the expected value ($\mu_{\omega}$) and the variance $\sigma_{\omega}^2$ for each element of $\vec{s}_x$, the distribution is completely specified.

If $\mat{C}_{s_x}$ denotes the covariance matrix of $\vec{s}_x$, then the variance of a element of $\vec{s}_x$ can be found on its diagonal.
Using the relation for $\vec{s}_x$, we can compute the covariance matrix $\mat{C}_{s_x}$ as:

\begin{align*}
\mat{C}_{s_x} &= E\left[\vec{s}_x\vec{s}_x^H\right] - E\left[\vec{s}\right]E\left[\vec{s}^H\right] \\
&= E\left[\left(\mat{F} \mat{R}^{\dagger}\vec{r}_y\right) \left( \mat{F}\mat{R}^{\dagger}\vec{r}_y\right)^H\right] - E\left[\mat{F}\mat{R}^{\dagger}\vec{r}_y\right]E\left[\left(\mat{F}\mat{R}^{\dagger}\vec{r}_y\right)^H\right] \\
&= \mat{F}\mat{R}^{\dagger} E\left[ \vec{r}_y\vec{r}_y^H\right]  \mat{R}^{\dagger H}\mat{F}^H -  \mat{F}\mat{R}^{\dagger} E\left[ \vec{r}_y\right] E\left[\vec{r}_y^H\right]   \mat{R}^{\dagger H}\mat{F}^H \\
&= \mat{F}\mat{R}^{\dagger} \mat{C}_{r_y} \mat{R}^{\dagger H}\mat{F}^H
\end{align*}

Let $\mat{C}_{r_y}$ denote the covariance matrix of of $\vec{r}_y$, with its elements given by

\begin{align}\label{eq:cov_ry}
(\mat{C}_{r_y})_{i,j} &= \text{Cov}(\vec{r_{y_t,y_u}}_i,\vec{r_{y_v, y_w}}_j).
\end{align}

As stated in \cite{ariananda2012compressive}, under the assumption that the elements of $\vec{x}$ are i.i.d. circular complex gaussian distributed, the expression for the covariance in \cref{eq:cov_ry} simplifies to:

\begin{align*}
\text{Cov}(\vec{r_{y_t,y_u}}_i,\vec{r_{y_v, y_w}}_j) &= \frac{\sigma_n^4 \vec{r_{c_t,c_v}}_N \vec{\overline{r}_{c_u,c_w}}_N \delta \left[ j-i\right]}{d}
\end{align*}.

Now that we have analyzed how to compute the variance of each element of $\vec{s}_x$, we will analyze the expression of their expected value ($\mu$).

\begin{align*}
E\left[\vec{s}_x\right] &= \mat{F}\mat{R}^{\dagger}E\left[\vec{r}_y\right] 
\end{align*}.

The elements of $(\vec{r}_y$ are given by 
\begin{align*}
\vec{r}_{y_i, y_j}[k] &= \vec{r}_{c_i,c_j} \ast \vec{r}_x & \text{\cref{th:convolution-correlation}} \\
&=  \left( \vec{r}_{c_i,c_j}\right)_N  \vec{\delta}_N
\end{align*}

Now that we both know the variance and mean of each element, we obtain that our threshold $\gamma_{\omega}$ given a false alarm probability $p_{fa}$:

\begin{align*}
Q^{-1}(p_{fa})\sigma_{\omega} + \mu_{\omega}
\end{align*}

This concludes the main analysis.

\end{document}